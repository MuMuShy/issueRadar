<mat-card appearance="outlined" class="recommendation-card">
  <mat-card-header>
    <mat-icon mat-card-avatar>auto_awesome</mat-icon>
    <mat-card-title>AI Label Recommendations</mat-card-title>
    <mat-card-subtitle>Get suggested GitHub issue labels using AI</mat-card-subtitle>
  </mat-card-header>

  <mat-card-content>
    <form [formGroup]="descriptionForm" class="description-form" (ngSubmit)="onSubmit()">
      <mat-form-field appearance="outline" class="full-width" style="position: relative;">
        <mat-label>Describe your issue or feature</mat-label>
        <textarea 
          matInput 
          formControlName="description" 
          rows="3"
          placeholder="E.g., 'Add dark mode support to the application with a toggle in the navbar'"
          (keydown.enter)="onEnter($event)"
        ></textarea>
        <button mat-fab color="primary" type="submit"
          [disabled]="isLoading || !descriptionForm.get('description')?.value || descriptionForm.get('description')?.value.length <= 10"
          class="enter-btn">
          <mat-icon>send</mat-icon>
        </button>
      </mat-form-field>
    </form>

    <div class="recommendations-container" *ngIf="descriptionForm.get('description')?.value">
      <h3 class="recommendations-title">AI Recommended Labels</h3>

      <div *ngIf="!isLoading">
        <div><strong>Query：</strong>{{ lastQuery || '-' }}</div>
        <div><strong>Labels：</strong>{{ recommendedTags.length ? recommendedTags.join(', ') : '-' }}</div>
        <div><strong>Language：</strong>{{ lastLanguage || '-' }}</div>
      </div>
      
      <div class="loading-container" *ngIf="isLoading">
        <mat-spinner diameter="24"></mat-spinner>
        <span>Generating recommendations...</span>
      </div>
      
      <div class="tags-container" *ngIf="!isLoading && recommendedTags.length > 0">
        <mat-chip-listbox aria-label="Recommended Tags">
          <mat-chip-option 
            *ngFor="let tag of recommendedTags" 
            color="primary"
            [selectable]="true"
            class="tag-chip">
            {{ tag }}
          </mat-chip-option>
        </mat-chip-listbox>
        <p class="recommendation-hint">Click on a tag to select it</p>
      </div>
      
      <div class="empty-recommendations" *ngIf="!isLoading && recommendedTags.length === 0">
        <p>Start typing to get AI-powered label recommendations</p>
      </div>
    </div>
  </mat-card-content>
</mat-card>